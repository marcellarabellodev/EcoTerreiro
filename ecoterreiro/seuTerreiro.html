<!DOCTYPE html>
<html lang="PT-BR">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content />
        <meta name="author" content />
        <title>EcoTerreiro - Seu Terreiro</title>
        
        <!-- *** Favicon *** -->
        <link rel="icon" type="image/x-icon" href="./images/favicon.ico" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
        <link href="css/styles.css" rel="stylesheet" />
        <style>
            /* Estilos personalizados para o formulário */
            .form-section {
                padding: 60px 0;
                background-color: #f8f9fa;
            }
            .form-section h1 {
                color: #212529;
                margin-bottom: 40px;
                text-align: center;
            }
            .form-label {
                font-weight: bold;
                margin-bottom: 8px;
            }
            .form-control {
                border-radius: 0.25rem;
                padding: 10px;
                margin-bottom: 20px;
            }
            .form-check {
                margin-bottom: 10px;
            }
            .form-check-input {
                margin-top: 0.3em;
            }
            .form-check-label {
                margin-left: 0.5em;
            }
            .hidden {
                display: none !important;
            }
            .btn-primary {
                background-color: #0d6efd; /* Azul padrão do Bootstrap */
                border-color: #0d6efd;
            }
            .btn-primary:hover {
                background-color: #0b5ed7;
                border-color: #0a58ca;
            }
        </style>
    </head>

    <body class="d-flex flex-column">
        <main class="flex-shrink-0">
             <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
                <div class="container px-5">
                    <a class="navbar-brand" href="index.html">EcoTerreiro</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                            <li class="nav-item"><a class="nav-link" href="index.html">Início</a></li>
                            <li class="nav-item"><a class="nav-link" href="sobre.html">Sobre</a></li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" id="navbarDropdownGuia" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Guia</a>
                                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdownGuia">
                                    <li><a class="dropdown-item" href="energiaSolar.html">Energia Solar</a></li>
                                    <li><a class="dropdown-item" href="agua.html">Captação de água de chuva</a></li>
                                    <li><a class="dropdown-item" href="coleta.html">Coleta seletiva</a></li>
                                    <li><a class="dropdown-item" href="ervasMedicinais.html">Jardim de ervas medicinais</a></li>
                                </ul>
                            </li>
                            <li class="nav-item"><a class="nav-link" href="seuTerreiro.html">Seu Terreiro</a></li>
                        </ul>
                    </div>
                </div>
            </nav>

        <!-- *** Criando formulário *** -->
            <section class="py-5 form-section">
                <div class="container px-5 my-5">
                    <div class="text-center mb-5">
                        <h1 class="fw-bolder">Informações do Seu Terreiro</h1>
                        <p class="lead fw-normal text-muted mb-0">Ajude-nos a entender como a sustentabilidade pode florescer em sua comunidade!</p>
                    </div>
                    <div class="row gx-5 justify-content-center">
                        <div class="col-lg-8 col-xl-6">
                            <form id="formTerreiro">
                                <div class="mb-3">
                                    <label class="form-label" for="nome_terreiro">Nome do Terreiro:</label>
                                    <input type="text" id="nome_terreiro" name="nome_terreiro" class="form-control" placeholder="Nome do seu terreiro" required />
                                </div>
                        </div>
                    </div>

                    <div class="row gx-5 justify-content-center">
                        <div class="col-lg-8 col-xl-6">
                            <form id="formTerreiro">
                                <div class="mb-3">
                                    <label class="form-label" for="end_terreiro">Endereço:</label>
                                    <textarea id="end_terreiro" name="end_terreiro" class="form-control" placeholder="Endereço completo" required></textarea>
                                </div>
                        </div>
                    </div>

                    <div class="row gx-5 justify-content-center">
                        <div class="col-lg-8 col-xl-6">
                            <form id="formTerreiro">
                                <div class="mb-3">
                                    <label class="form-label" for="nome_paimae_santo_terreiro">Nome Pai/Mãe de Santo:</label>
                                    <input type="text" id="nome_paimae_santo_terreiro" name="nome_paimae_santo_terreiro" class="form-control" placeholder="Nome Pai/Mãe de Santo" required />
                                </div>
                        </div>
                    </div>

                    <div class="row gx-5 justify-content-center">
                        <div class="col-lg-8 col-xl-6">
                            <form id="formTerreiro">
                                <div class="mb-3">
                                    <label class="form-label" for="anos_terreiro">Quantos anos tem o Terreiro?</label>
                                    <input type="text" id="anos_terreiro" name="anos_terreiro" class="form-control" placeholder="Quantos anos tem o Terreiro?"  required />
                                </div>
                        </div>
                    </div>

                    <div class="row gx-5 justify-content-center">
                        <div class="col-lg-8 col-xl-6">
                            <form id="formTerreiro">
                                <div class="mb-3">
                                    <label class="form-label" for="dificuldade_para_aplicar_terreiro">Qual a maior dificuldade do seu Terreiro em aplicar a sustentabilidade?</label>
                                    <input  type="text" id="dificuldade_para_aplicar_terreiro" name="dificuldade_para_aplicar_terreiro" class="form-control" placeholder="Qual a maior dificuldade?"  required />
                                </div>
                        </div>
                    </div>

                    <div class="row gx-5 justify-content-center">
                        <div class="col-lg-8 col-xl-6">
                            <form id="formTerreiro">
                                <div class="mb-3">
                                    <label class="form-label" for="praticas_que_possui_terreiro">Quais práticas de sustentabilidade seu Terreiro já possui?</label>
                                    <input type="text" id="praticas_que_possui_terreiro" name="praticas_que_possui_terreiro" class="form-control" placeholder="Quais práticas já possui?"  required />
                                </div>
                        </div>
                    </div>

                    <div class="row gx-5 justify-content-center">
                        <div class="col-lg-8 col-xl-6">
                            <form id="formTerreiro">
                                <div class="mb-3">
                                    <p>Esse site fez diferença para o seu Terreiro?</p>
                                    <input type="radio" id="fez_diferenca_site_Sim" name="fez_diferenca_site" value="true">
                                    <label for="fez_diferenca_site_Sim">Sim</label>
                                    <input type="radio" id="fez_diferenca_site_Nao" name="fez_diferenca_site" value="false">
                                    <label for="fez_diferenca_site_Nao">Não</label>
                                </div>
                        </div>
                    </div>

                     <div class="row gx-5 justify-content-center">
                        <div class="col-lg-8 col-xl-6">
                            <form id="formTerreiro">
                                <div class="mb-3">
                                    <p>Você apresentou esse site para sua comunidade?</p>
                                    <input type="radio" id="apresentou_para_comunidade_site_Sim" name="apresentou_para_comunidade_site" value="true">
                                    <label for="apresentou_para_comunidade_site_Sim">Sim</label>
                                    <input type="radio" id="apresentou_para_comunidade_site_Não" name="apresentou_para_comunidade_site" value="false">
                                    <label for="apresentou_para_comunidade_site_Não">Não</label>
                                </div>
                        </div>
                    </div>

                    <div class="row gx-5 justify-content-center">
                        <div class="col-lg-8 col-xl-6">
                            <form id="formTerreiro">
                                <div class="mb-3">
                                    <p>Você aplicou alguma prática de sustentabilidade, aqui citada, para o seu terreiro?</p>
                                    <input type="radio" id="aplicou_alguma_pratica_site_no_terreiro_Sim" name="aplicou_alguma_pratica_site_no_terreiro" value="true">
                                    <label for="aplicou_alguma_pratica_site_no_terreiro_Sim">Sim</label>
                                    <input type="radio" id="aplicou_alguma_pratica_site_no_terreiro_Não" name="aplicou_alguma_pratica_site_no_terreiro" value="false" checked>
                                    <label for="aplicou_alguma_pratica_site_no_terreiro_Não">Não</label>
                                </div>
                        </div>
                    </div>

                    
                    <div class="row gx-5 justify-content-center" id="qualPraticaContainer">
                        <div class="col-lg-8 col-xl-6">
                            <form id="formTerreiro">
                             <div class="mb-3">
                                <p>Qual/quais prática(s) você aplicou?</p>
                                <input type="checkbox" id="energiaSolar" name="praticasAplicadas" value="energiaSolar">
                                <label for="energiaSolar">Energia Solar</label><br>
                                <input type="checkbox" id="captacaoAgua" name="praticasAplicadas" value="captacaoAgua">
                                <label for="captacaoAgua">Captação de água de chuva</label><br>
                                <input type="checkbox" id="coletaSeletiva" name="praticasAplicadas" value="coletaSeletiva">
                                <label for="coletaSeletiva">Coleta seletiva</label><br>
                                <input type="checkbox" id="jardimErvas" name="praticasAplicadas" value="jardimErvas">
                                <label for="jardimErvas">Jardim de ervas medicinais</label><br>
                            </div>
                                <label class="form-label" for="aplicaraOutra">Você aplicará mais alguma? Se sim, qual?</label>
                                <input class="form-control" id="aplicaraOutra" type="text" placeholder="Aplicará mais alguma?"  required />
                            </form>
                        </div>
                    </div>
                </div>


                <div class="row gx-5 justify-content-center" id="qualPraticaContainer">
                    <div class="col-lg-8 col-xl-6">
                        <form id="formTerreiro" method="POST" action="http://localhost:8080/api/terreiros">
                            <button type="submit" class="submit-button">Enviar Formulário</button>
                        </form>
                    </div>
                </div>
            </section>

<!-- Esse Script é responsável por controlar a visibilidade da pergunta sobre as práticas aplicadas. 
    Ele detecta a mudança na seleção "Sim" ou "Não" e mostra/esconde o campo correspondente, 
    oferecendo uma estrutura clara e interativa-->
     <script>
        document.addEventListener('DOMContentLoaded', function() {
            const praticaAplicadaSim = document.getElementById('praticaAplicadaSim');
            const praticaAplicadaNao = document.getElementById('praticaAplicadaNao');
            const qualPraticaContainer = document.getElementById('qualPraticaContainer');

            function toggleQualPratica() {
                if (praticaAplicadaSim.checked) {
                    qualPraticaContainer.classList.remove('hidden');
                } else {
                    qualPraticaContainer.classList.add('hidden');
                }
            }

            praticaAplicadaSim.addEventListener('change', toggleQualPratica);
            praticaAplicadaNao.addEventListener('change', toggleQualPratica);

            // Inicializa o estado do container ao carregar a página
            toggleQualPratica();
        });
    </script>

<!-- Para uma experiência mais moderna e para lidar com a resposta do backend sem recarregar a página,
 usei JavaScript (Fetch API) para enviar os dados do formulário como JSON. Isso é mais recomendado para APIs REST.
-->
    <script>
        document.getElementById('formTerreiro').addEventListener('submit', function(event) {
            event.preventDefault(); // Impede o envio padrão do formulário

            const formData = new FormData(this); // Pega os dados do formulário
            const data = {};
            for (const [key, value]  of formData.entries()) {
                // Trata booleanos de strings "true"/"false" para booleanos reais
                if (value === "true") {
                    data[key] = true;
                } else if (value === "false") {
                    data[key] = false;
                } else if (key === "anos_terreiro" && value !== "") { // Converte anos_terreiro para número
                    data[key] = parseInt(value, 10);
                }
                else if (value !== "") { // Adiciona outros campos se não estiverem vazios
                    data[key] = value;
                }
            }

            fetch('http://localhost:8080/api/terreiros', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data), // Converte o objeto JavaScript para JSON
            })
            .then(response => {
                if (!response.ok) {
                    // Se a resposta não for 2xx (ex: 400, 500)
                    return response.json().then(err => { throw new Error(err.message || 'Erro ao cadastrar') });
                }
                return response.json(); // Se sucesso, retorna o JSON da resposta
            })
            .then(result => {
                console.log('Sucesso:', result);
                alert('Terreiro cadastrado com sucesso!');
                this.reset(); // Limpa o formulário
            })
            .catch(error => {
                console.error('Erro:', error);
                alert('Erro ao cadastrar terreiro: ' + error.message);
            });
        });
    </script>   

</main>
        <!-- Footer-->
        <footer class="bg-dark py-4 mt-auto">
            <div class="container px-5">
                <div class="row align-items-center justify-content-between flex-column flex-sm-row">
                    <div class="col-auto"><div class="small m-0 text-white"> &copy;  2025 Projeto de Extensão - Faculdade Descomplica </div>
                </div>
                </div>
            </div>
        </footer>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
    </body>
</html>
